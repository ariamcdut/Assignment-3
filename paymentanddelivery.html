<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MR WARES: Payment Details</title>

    <!-- Added Links -->
     <link rel="stylesheet" href="stylesheet.css">
     <script src="shop.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">

    <!-- Icons -->
    <script src="https://kit.fontawesome.com/e96d6d78ca.js" crossorigin="anonymous"></script>
</head>
<body>
    <!--Navigation-->
    <nav>
        <ul>
            <div style="padding-right: 86vw;">
                <li id="homeicon"><a href="mrwares.html"><i class="fa-solid fa-house"></i></a></li>
            </div>
            <div>
                <li style="padding-right: 1vw;">
                    <a href="cart.html">
                        <i class="fa-solid fa-cart-shopping"></i>
                        <span id="cart-count">0</span> 
                    </a>
                </li>
                <li><a href="user.html"><i class="fa-solid fa-user"></i></a></li>
            </div>
        </ul>
    </nav>
    <main class="paymentpage">
        <section class="payment-main">
        <form id="paymentForm" action="/process-payment" method="POST">
            <section class="order-summary-section">
                <h2>Order Summary</h2>
                <div id="order-summary-details">
                    <p>Subtotal: $150.00</p>
                    <p>Shipping: $10.00</p>
                    <p class="order-total">Total: $160.00</p>
                </div>
            </section>

            <section class="payment-info-section">
                <h2>Payment Information</h2>

                <div class="form-group">
                    <label for="card-number">Card Number</label>
                    <div class="input-icon-wrapper">
                        <input type="text" id="card-number" name="cardNumber" 
                               placeholder="•••• •••• •••• ••••" 
                               inputmode="numeric" pattern="[0-9\s]{13,19}" 
                               autocomplete="cc-number" maxlength="19" required>
                        <i class="far fa-credit-card icon"></i> </div>
                </div>

                <div class="form-row">
                    <div class="form-group expiry-cvc">
                        <label for="expiry-date">Expiry Date</label>
                        <input type="text" id="expiry-date" name="expiryDate" 
                               placeholder="MM/YY" pattern="(0[1-9]|1[0-2])\/?([0-9]{2})" 
                               autocomplete="cc-exp" maxlength="5" required>
                    </div>

                    <div class="form-group expiry-cvc">
                        <label for="cvc">CVC</label>
                        <div class="input-icon-wrapper">
                            <input type="text" id="cvc" name="cvc" 
                                   placeholder="•••" inputmode="numeric" 
                                   pattern="[0-9]{3,4}" autocomplete="cc-csc" maxlength="4" required>
                            <i class="fas fa-lock icon"></i> </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="card-holder-name">Card Holder Name</label>
                    <input type="text" id="card-holder-name" name="cardHolderName" 
                           placeholder="Full Name on Card" autocomplete="cc-name" required>
                </div>
            </section>

            <section class="billing-address-section">
                <h2>Billing Address</h2>
                <p class="address-note">This must match the address on your card statement.</p>

                <div class="form-group">
                    <label for="billing-address1">Address Line 1</label>
                    <input type="text" id="billing-address1" name="billingAddress1" 
                           placeholder="Street address, P.O. box, company name, c/o" autocomplete="billing address-line1" required>
                </div>

                <div class="form-group">
                    <label for="billing-address2">Address Line 2 (Optional)</label>
                    <input type="text" id="billing-address2" name="billingAddress2" 
                           placeholder="Apartment, suite, unit, building, floor, etc." autocomplete="billing address-line2">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="billing-city">City</label>
                        <input type="text" id="billing-city" name="billingCity" 
                               placeholder="City" autocomplete="billing address-level2" required>
                    </div>
                    <div class="form-group">
                        <label for="billing-state">State / Province</label>
                        <input type="text" id="billing-state" name="billingState" 
                               placeholder="State or Province" autocomplete="billing address-level1" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="billing-zip">ZIP / Postcode</label>
                        <input type="text" id="billing-zip" name="billingZip" 
                               placeholder="e.g., 3000" pattern="[0-9]{4,10}" autocomplete="billing postal-code" required>
                    </div>
                    <div class="form-group">
                        <label for="billing-country">Country</label>
                        <select id="billing-country" name="billingCountry" autocomplete="billing country" required>
                            <option value="">Select Country</option>
                            <option value="AU">Australia</option>
                            <option value="US">United States</option>
                            <option value="CA">Canada</option>
                            </select>
                    </div>
                </div>
            </section>

            <section class="contact-info-section">
                <h2>Contact Information</h2>
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" 
                           placeholder="your.email@example.com" autocomplete="email" required>
                </div>
                <div class="form-group">
                    <label for="phone">Phone Number (Optional)</label>
                    <input type="tel" id="phone" name="phone" 
                           placeholder="e.g., +61 412 345 678" autocomplete="tel">
                </div>
            </section>
            <a href="cart.html" id="returntocart">Return to cart</a>
            <button type="submit" class="submit-button">Pay Now</button>
            <p class="security-note">
                <i class="fas fa-lock"></i> Your information is secure and encrypted.
            </p>
            </form>
        </section>
    </main>
    <footer>
        <!-- Footer -->
        <div>
            <h3>About You</h3>
            <p>Your saved people</p>
            <p>Your liked items</p>
            <p>Your purchases</p>
        </div>
        <div>
            <h3>Policies</h3>
            <p>Terms and Conditions</p>
            <p>Returns Policy</p>
            <p>Privacy Policy</p>
        </div>
        <div>
            <h3>Connect</h3>
            <p>Facebook</p>
            <p>Instagram:</p>
            <p>Submit a Form</p>
        </div>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const paymentForm = document.getElementById('paymentForm');

            if (paymentForm) {
                paymentForm.addEventListener('submit', (event) => {
                    event.preventDefault();

                    let isValid = true;
                    const requiredInputs = paymentForm.querySelectorAll('[required]');

                    requiredInputs.forEach(input => {
                        if (!input.value.trim()) {
                            input.classList.add('is-invalid');
                            isValid = false;
                        } else {
                            input.classList.remove('is-invalid');
                        }
                    });

                    if (!isValid) {
                        alert('Please fill in all required fields.');
                        return; 
                    }

                    console.log("Simulating payment success...");

                    if (typeof emptyCart === 'function') {
                        completeCart();
                        console.log("Cart has been reset.");
                    } else {
                        console.error("completeCart function not found in shop.js or not loaded.");

                        localStorage.removeItem('shoppingCart');
                    }
                    
                    window.location.replace('confirmation.html');
                });
            }
        });
    </script>
</body>
</html>